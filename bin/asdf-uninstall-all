#!/bin/bash -eu

function uninstall() {
    name=$1
    current=$(cd $HOME && asdf current $name 2>/dev/null | tr -s ' ' ' ' | cut -d ' ' -f 2)
    for v in $(asdf list $name | sed -e 's#\*##g'); do
        if [ "$v" != "$current" ]; then
            echo "> asdf uninstall $name $v"
            asdf uninstall $name $v
        fi
    done
}

if [ "${1}" = "--all" ]; then
    for p in $(asdf plugin list); do
        uninstall $p
    done
else
    uninstall $1
fi
